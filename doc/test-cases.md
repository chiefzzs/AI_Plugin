# AI_Plugin 测试用例文档

## 1. 单元测试

根据模块-实现文件中的模块划分，单元测试部分按照以下9个模块进行组织：

### 1.1 扩展激活模块 (MOD-001) 测试

**测试用例1：插件激活测试**
- **目的**：验证插件能够正确初始化和激活
- **步骤**：
  1. 模拟VSCode环境
  2. 调用`activate`函数
  3. 验证插件是否成功激活并初始化各模块
  4. 验证所需的命令是否被正确注册
- **预期结果**：插件成功激活，无错误抛出
- **测试数据**：VSCode扩展上下文
- **测试工具**：Jest, VSCode Test API

**测试用例2：命令注册测试**
- **目的**：验证插件命令是否正确注册
- **步骤**：
  1. 激活插件
  2. 验证vscode.commands.registerCommand被调用
  3. 检查注册的命令ID是否包含核心命令
- **预期结果**：所有必要的命令（showWebview、executeCommand、clearTerminals）都被正确注册
- **测试数据**：命令名称
- **测试工具**：Jest, VSCode Test API

**测试用例3：插件停用测试**
- **目的**：验证插件能够正确停用并清理资源
- **步骤**：
  1. 模拟插件激活
  2. 调用`deactivate`函数
  3. 验证资源是否被正确清理
- **预期结果**：插件正确停用，所有相关资源被正确清理
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

### 1.2 Webview管理模块 (MOD-002) 测试

**测试用例4：WebviewManager单例模式测试**
- **目的**：验证WebviewManager实现了正确的单例模式
- **步骤**：
  1. 多次调用`WebviewManager.getInstance()`方法
  2. 验证返回的实例是否为同一个对象
- **预期结果**：多次调用返回同一个WebviewManager实例
- **测试数据**：无
- **测试工具**：Jest

**测试用例5：Webview创建和显示测试**
- **目的**：验证WebviewManager能够正确创建和显示Webview面板
- **步骤**：
  1. 获取WebviewManager实例
  2. 调用`createOrShowWebview`方法
  3. 验证Webview面板是否被正确创建
- **预期结果**：Webview面板成功创建并显示
- **测试数据**：VSCode扩展上下文
- **测试工具**：Jest, VSCode Webview Mock

**测试用例6：Webview消息通信测试**
- **目的**：验证WebviewManager能够正确处理和发送消息
- **步骤**：
  1. 创建WebviewManager实例和Webview面板
  2. 模拟Webview发送消息
  3. 验证消息是否被正确处理
  4. 调用`sendMessageToWebview`方法发送消息到Webview
  5. 验证消息是否被正确发送
- **预期结果**：Webview发送的消息被正确处理，插件发送的消息被正确传递到Webview
- **测试数据**：不同类型的消息对象
- **测试工具**：Jest, VSCode Webview Mock

**测试用例7：HTML模板加载测试**
- **目的**：验证HTML模板文件能够正确加载和解析
- **步骤**：
  1. 准备有效的HTML模板文件
  2. 调用`getWebviewContent`方法加载模板
  3. 验证返回的HTML内容是否包含模板中的关键元素
- **预期结果**：成功加载模板，返回的HTML内容包含预期的HTML结构和元素
- **测试数据**：有效的HTML模板文件路径
- **测试工具**：Jest

**测试用例8：模板加载失败回退机制测试**
- **目的**：验证当HTML模板加载失败时，系统能够正确使用默认HTML内容
- **步骤**：
  1. 提供无效的模板文件路径或删除模板文件
  2. 调用`getWebviewContent`方法尝试加载模板
  3. 验证返回的HTML内容是否为默认的HTML内容
- **预期结果**：加载失败时使用默认HTML内容，确保Webview能够正常显示
- **测试数据**：无效的模板文件路径
- **测试工具**：Jest, MockFS

**测试用例9：模板变量替换测试**
- **目的**：验证HTML模板中的变量能够被正确替换
- **步骤**：
  1. 准备包含变量占位符的HTML模板
  2. 调用模板加载方法，传入有效的资源路径
  3. 验证模板中的变量是否被正确替换为实际的资源路径
- **预期结果**：模板中的变量被正确替换为实际的资源路径
- **测试数据**：包含变量占位符的HTML模板，有效的资源路径
- **测试工具**：Jest, MockFS

**测试用例10：模板结构完整性测试**
- **目的**：验证加载的HTML模板结构完整，不包含语法错误
- **步骤**：
  1. 读取静态HTML模板文件
  2. 验证文件内容完整性
  3. 处理模板占位符
- **预期结果**：能够正确读取和处理HTML模板
- **测试数据**：有效的HTML模板文件
- **测试工具**：Jest, HTML解析器

### 1.3 Vue应用模块 (MOD-003) 测试

**测试用例11：Vue库加载测试**
- **目的**：验证Webview能够正确加载Vue 2库
- **步骤**：
  1. 模拟Webview环境
  2. 调用getWebviewContent方法获取HTML内容
  3. 验证内容中包含Vue 2库的引用
- **预期结果**：HTML内容中包含正确的Vue 2库引用
- **测试数据**：VSCode扩展上下文
- **测试工具**：Jest, MockFS

**测试用例12：Vue-i18n加载测试**
- **目的**：验证Webview能够正确加载Vue-i18n库
- **步骤**：
  1. 模拟Webview环境
  2. 调用getWebviewContent方法获取HTML内容
  3. 验证内容中包含Vue-i18n库的引用
- **预期结果**：HTML内容中包含正确的Vue-i18n库引用
- **测试数据**：VSCode扩展上下文
- **测试工具**：Jest, MockFS

**测试用例13：Vue组件功能测试**
- **目的**：验证Vue组件的功能是否正常工作
- **步骤**：
  1. 激活插件并打开Webview
  2. 测试Vue组件的各种功能
  3. 验证组件的状态管理和事件处理
- **预期结果**：Vue组件的各种功能正常工作
- **测试数据**：测试数据
- **测试工具**：Jest, VSCode Test API

### 1.4 命令执行模块 (MOD-004) 测试

**测试用例14：showWebview命令测试**
- **目的**：验证showWebview命令能够正常执行
- **步骤**：
  1. 激活插件
  2. 获取并执行showWebview命令回调
  3. 验证executeCommand被调用
- **预期结果**：命令能够正常执行，无错误抛出
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

**测试用例15：executeCommand命令测试 (主执行模式)**
- **目的**：验证executeCommand命令能够在主执行模式下正常执行并调用tools/interactive-tool.py
- **步骤**：
  1. 激活插件
  2. 获取并执行executeCommand命令回调，指定主执行模式
  3. 验证命令能够执行而不抛出异常
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证结果以JSON格式返回
- **预期结果**：命令能够正常执行，无错误抛出
- **测试数据**：测试命令和主执行模式参数
- **测试工具**：Jest, VSCode Test API

**测试用例16：executeCommand命令测试 (界面输出模式)**
- **目的**：验证executeCommand命令能够在界面输出模式下正常执行并调用tools/execinfo.py
- **步骤**：
  1. 激活插件
  2. 获取并执行executeCommand命令回调，指定界面输出模式
  3. 验证命令能够执行而不抛出异常
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证结果以JSON格式返回
- **预期结果**：命令能够正常执行，无错误抛出
- **测试数据**：测试命令和界面输出模式参数
- **测试工具**：Jest, VSCode Test API

**测试用例17：clearTerminals命令测试**
- **目的**：验证clearTerminals命令能够正常执行
- **步骤**：
  1. 激活插件
  2. 模拟TerminalManager的disposeAllTerminals方法
  3. 获取并执行clearTerminals命令回调
  4. 验证是否调用了TerminalManager清除终端
- **预期结果**：命令能够正常执行，调用了相应的TerminalManager方法
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

### 1.5 终端管理模块 (MOD-005) 测试

#### 1.5.1 子模块：工具脚本 (MOD-005-SUB01) 测试

**测试用例18：交互式工具JSON输入处理测试**
- **目的**：验证interactive-tool.py能够正确解析JSON格式输入（包含序列号字段）
- **步骤**：
  1. 准备包含content字段、序列号字段和工程目录的JSON输入
  2. 调用interactive-tool.py并传入JSON输入
  3. 验证工具能够正确解析输入内容
- **预期结果**：成功解析JSON输入，正确提取content字段、序列号和附加信息
- **测试数据**：包含content字段、序列号字段和工程目录的JSON字符串
- **测试工具**：pytest

**测试用例19：交互式工具JSON输出生成测试**
- **目的**：验证interactive-tool.py能够生成符合要求的JSON格式输出（包含序列号字段）
- **步骤**：
  1. 准备包含序列号字段的JSON输入
  2. 调用interactive-tool.py执行命令
  3. 捕获输出结果
  4. 验证输出是否为有效的JSON数组
  5. 检查JSON数组中是否包含正确的返回类型、结束标识和与输入相同的序列号
- **预期结果**：输出符合要求的JSON数组，包含正确的返回类型、结束标识和与输入相同的序列号
- **测试数据**：包含序列号字段的测试命令和参数
- **测试工具**：pytest, JSON解析器

**测试用例20：执行信息工具JSON输入处理测试**
- **目的**：验证execinfo.py能够正确解析JSON格式输入（包含序列号字段）
- **步骤**：
  1. 准备包含content字段、序列号字段和工程目录的JSON输入
  2. 调用execinfo.py并传入JSON输入
  3. 验证工具能够正确解析输入内容
- **预期结果**：成功解析JSON输入，正确提取content字段、序列号和附加信息
- **测试数据**：包含content字段、序列号字段和工程目录的JSON字符串
- **测试工具**：pytest

**测试用例21：执行信息工具JSON输出生成测试**
- **目的**：验证execinfo.py能够生成符合要求的JSON格式输出（包含序列号字段）
- **步骤**：
  1. 准备包含序列号字段的JSON输入
  2. 调用execinfo.py执行命令
  3. 捕获输出结果
  4. 验证输出是否为有效的JSON数组
  5. 检查JSON数组中是否包含正确的返回类型、结束标识和与输入相同的序列号
- **预期结果**：输出符合要求的JSON数组，包含正确的返回类型、结束标识和与输入相同的序列号
- **测试数据**：包含序列号字段的测试命令和参数
- **测试工具**：pytest, JSON解析器
- **预期结果**：输出符合要求的JSON数组，包含正确的返回类型、错误信息和结束标识
- **测试数据**：测试命令和参数
- **测试工具**：pytest, JSON解析器

**测试用例22：工具脚本多次输出支持测试**
- **目的**：验证工具脚本能够支持多次输出并正确处理数据
- **步骤**：
  1. 调用工具脚本执行会产生多次输出的命令
  2. 捕获并分析输出流
  3. 验证每次输出都被正确格式化
- **预期结果**：多次输出都被正确格式化并返回，无数据丢失
- **测试数据**：会产生多次输出的复杂命令
- **测试工具**：pytest

**测试用例23：工具脚本递归处理测试**
- **目的**：验证工具脚本能够正确处理递归调用的命令
- **步骤**：
  1. 调用工具脚本执行包含递归调用的命令
  2. 捕获输出结果
  3. 验证递归调用被正确处理和返回
- **预期结果**：递归调用被正确处理，输出符合要求
- **测试数据**：包含递归调用的命令
- **测试工具**：pytest

**测试用例24：工具脚本与Vue前端命令执行-渲染闭环测试**
- **目的**：验证工具脚本与Vue前端之间的命令执行-渲染闭环是否正常工作
- **步骤**：
  1. 模拟Vue前端发送命令请求
  2. 工具脚本接收并执行命令
  3. 工具脚本返回JSON格式结果，包含结束标识
  4. 验证Vue前端能够正确识别结束标识并继续处理
- **预期结果**：Vue前端能够正确识别结束标识，完成当前命令处理并继续上一命令剩余部分渲染
- **测试数据**：包含多种返回类型的复杂命令
- **测试工具**：pytest, 模拟Vue前端环境

#### 1.5.2 终端管理核心功能测试

**测试用例25：TerminalManager主执行模式测试**
- **目的**：验证TerminalManager能够正确使用主执行模式（调用tools/interactive-tool.py）执行命令
- **步骤**：
  1. 创建TerminalManager实例
  2. 调用`executeCommand`方法，使用主执行模式执行简单命令
  3. 验证命令执行结果是否以正确的JSON格式返回
- **预期结果**：能够正确创建、执行命令，并返回符合CommandResult格式的结果
- **测试数据**：简单命令和JSON格式输入
- **测试工具**：Jest, VSCode Terminal Mock

**测试用例19：TerminalManager界面输出模式测试**
- **目的**：验证TerminalManager能够正确使用界面输出模式（调用tools/execinfo.py）执行命令
- **步骤**：
  1. 创建TerminalManager实例
  2. 调用`executeCommand`方法，使用界面输出模式执行简单命令
  3. 验证命令执行结果是否以正确的JSON格式返回
- **预期结果**：能够正确创建、执行命令，并返回符合CommandResult格式的结果
- **测试数据**：简单命令和JSON格式输入
- **测试工具**：Jest, VSCode Terminal Mock

**测试用例20：TerminalManager JSON输入输出格式测试**
- **目的**：验证TerminalManager能够正确处理JSON格式的输入和输出
- **步骤**：
  1. 创建TerminalManager实例
  2. 调用`executeCommand`方法，传入包含命令和参数的JSON对象
  3. 验证返回的结果是否符合CommandResult接口定义
- **预期结果**：输入和输出均符合JSON格式要求
- **测试数据**：包含命令、参数和执行模式的JSON对象
- **测试工具**：Jest, VSCode Terminal Mock

**测试用例21：TerminalManager多终端管理测试**
- **目的**：验证TerminalManager能够正确管理多个终端实例
- **步骤**：
  1. 创建TerminalManager实例
  2. 多次调用`executeCommand`方法，使用不同的终端名称
  3. 验证每个命令都在正确的终端中执行
- **预期结果**：每个命令都在指定的终端中执行，多个终端实例被正确管理
- **测试数据**：多个不同的终端名称和命令
- **测试工具**：Jest, VSCode Terminal Mock

**测试用例22：TerminalManager资源清理测试**
- **目的**：验证TerminalManager能够正确清理不再使用的终端资源
- **步骤**：
  1. 创建TerminalManager实例
  2. 执行多个命令创建多个终端实例
  3. 调用`disposeAllTerminals`方法
  4. 验证所有终端实例都被正确清理
- **预期结果**：所有终端实例被正确关闭和清理，避免资源泄漏
- **测试数据**：多个终端实例
- **测试工具**：Jest, VSCode Terminal Mock

### 1.6 资源层 (MOD-006) 测试

**测试用例23：静态资源加载测试**
- **目的**：验证Webview能够正确加载静态资源（CSS、JavaScript文件）
- **步骤**：
  1. 模拟Webview环境
  2. 调用getWebviewContent方法获取HTML内容
  3. 验证内容中包含正确的静态资源引用
- **预期结果**：HTML内容中包含正确的静态资源引用
- **测试数据**：VSCode扩展上下文
- **测试工具**：Jest, MockFS

**测试用例24：资源加载错误处理测试**
- **目的**：验证当Webview资源加载失败时，系统能够正确处理
- **步骤**：
  1. 模拟Webview资源文件缺失或损坏
  2. 启动VSCode并激活插件
  3. 打开Webview
  4. 验证Webview是否能够使用备用资源或显示错误信息
- **预期结果**：Webview能够使用备用资源或显示清晰的错误信息
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

**测试用例25：Vue资源加载错误处理测试**
- **目的**：验证当Vue相关资源加载失败时，系统能够正确处理
- **步骤**：
  1. 模拟Vue库文件缺失或损坏
  2. 启动VSCode并激活插件
  3. 打开Webview
  4. 验证Webview是否能够使用备用方案或显示错误信息
- **预期结果**：Webview能够使用备用方案或显示清晰的错误信息
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

### 1.7 通信桥接模块 (MOD-007) 测试

**测试用例26：Webview与插件通信集成测试**
- **目的**：验证Webview与插件之间的通信功能
- **步骤**：
  1. 激活插件并创建Webview
  2. 从Webview向插件发送消息
  3. 验证插件是否正确接收和处理消息
  4. 从插件向Webview发送消息
  5. 验证Webview是否正确接收和处理消息
- **预期结果**：Webview和插件之间能够正确收发和处理消息
- **测试数据**：测试消息
- **测试工具**：Jest, VSCode Test API

**测试用例27：Webview消息通信测试**
- **目的**：验证Webview与插件之间的消息通信功能
- **步骤**：
  1. 启动VSCode并激活插件
  2. 打开Webview
  3. 执行会触发消息发送的操作
  4. 验证消息是否被正确发送和处理
- **预期结果**：消息被正确发送和处理
- **测试数据**：测试操作
- **测试工具**：Jest, VSCode Test API

### 1.8 服务集成模块 (MOD-008) 测试

**测试用例28：命令执行主模式集成测试**
- **目的**：验证从前端界面输入命令到后端使用主执行模式（调用tools/interactive-tool.py）执行的完整流程
- **步骤**：
  1. 激活插件并创建Webview
  2. 从Webview发送命令执行请求，指定主执行模式
  3. 验证命令被正确传递给TerminalManager
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证执行结果以JSON格式正确返回给前端
- **预期结果**：完整的命令执行流程正常工作，结果正确显示在前端
- **测试数据**：测试命令和执行模式
- **测试工具**：Jest, VSCode Test API

**测试用例29：命令执行界面模式集成测试**
- **目的**：验证从前端界面输入命令到后端使用界面输出模式（调用tools/execinfo.py）执行的完整流程
- **步骤**：
  1. 激活插件并创建Webview
  2. 从Webview发送命令执行请求，指定界面输出模式
  3. 验证命令被正确传递给TerminalManager
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证执行结果以JSON格式正确返回给前端
- **预期结果**：完整的命令执行流程正常工作，结果正确显示在前端
- **测试数据**：测试命令和执行模式
- **测试工具**：Jest, VSCode Test API

### 1.9 日志与状态模块 (MOD-009) 测试

**测试用例30：Logger工具测试**
- **目的**：验证Logger工具能够正确记录不同级别的日志信息
- **步骤**：
  1. 初始化Logger工具
  2. 调用不同级别的日志方法（info、error、debug、warn）
  3. 验证日志信息是否按预期格式输出到控制台或文件
- **预期结果**：日志工具能够正常工作，无错误抛出
- **测试数据**：不同级别的日志消息
- **测试工具**：Jest, Console Mock

**测试用例31：主执行模式错误处理测试**
- **目的**：验证插件能够正确处理主执行模式下命令执行失败的情况
- **步骤**：
  1. 激活插件
  2. 模拟TerminalManager在主执行模式下的executeCommand方法抛出异常
  3. 获取并执行executeCommand命令回调，指定主执行模式
  4. 验证错误日志记录
  5. 验证错误信息以JSON格式返回给前端
- **预期结果**：能够正确捕获异常并记录错误日志，错误信息正确返回
- **测试数据**：会导致执行失败的命令
- **测试工具**：Jest, VSCode Test API

**测试用例32：界面输出模式错误处理测试**
- **目的**：验证插件能够正确处理界面输出模式下命令执行失败的情况
- **步骤**：
  1. 激活插件
  2. 模拟TerminalManager在界面输出模式下的executeCommand方法抛出异常
  3. 获取并执行executeCommand命令回调，指定界面输出模式
  4. 验证错误日志记录
  5. 验证错误信息以JSON格式返回给前端
- **预期结果**：能够正确捕获异常并记录错误日志，错误信息正确返回
- **测试数据**：会导致执行失败的命令
- **测试工具**：Jest, VSCode Test API

**测试用例33：错误处理集成测试**
- **目的**：验证系统在遇到错误时的处理能力
- **步骤**：
  1. 激活插件
  2. 执行会导致错误的操作（如执行不存在的命令）
  3. 验证错误是否被正确捕获
  4. 验证错误信息是否被正确展示给用户
- **预期结果**：错误被正确捕获和处理，用户能够看到清晰的错误信息
- **测试数据**：会导致错误的操作
- **测试工具**：Jest, VSCode Test API

## 2. 集成测试

### 2.1 插件核心功能集成测试

#### 2.1.1 插件激活流程测试
**测试用例12：插件激活测试**
- **目的**：验证插件能够在VSCode中正确激活，并注册所需的命令和视图
- **步骤**：
  1. 模拟VSCode环境
  2. 调用`activate`函数
  3. 验证插件是否成功激活
  4. 验证所需的命令是否被正确注册
- **预期结果**：插件成功激活，无错误抛出
- **测试数据**：VSCode扩展上下文
- **测试工具**：Jest, VSCode Test API

#### 2.1.2 命令执行流程测试
**测试用例13：命令执行流程测试**
- **目的**：验证命令执行流程的完整功能链路
- **步骤**：
  1. 激活插件
  2. 调用`executeCommand`命令
  3. 验证命令是否被正确传递给TerminalManager
  4. 验证执行结果是否被正确处理和展示
- **预期结果**：命令被正确执行，执行结果被正确处理和展示
- **测试数据**：测试命令
- **测试工具**：Jest, VSCode Test API

#### 2.1.3 Webview与插件通信集成测试
**测试用例14：Webview与插件通信集成测试**
- **目的**：验证Webview与插件之间的通信功能
- **步骤**：
  1. 激活插件并创建Webview
  2. 从Webview向插件发送消息
  3. 验证插件是否正确接收和处理消息
  4. 从插件向Webview发送消息
  5. 验证Webview是否正确接收和处理消息
- **预期结果**：Webview和插件之间能够正确收发和处理消息
- **测试数据**：测试消息
- **测试工具**：Jest, VSCode Test API

### 2.2 前端与后端集成测试

#### 2.2.1 命令执行集成测试
**测试用例15：命令执行主模式集成测试**
- **目的**：验证从前端界面输入命令到后端使用主执行模式（调用tools/interactive-tool.py）执行的完整流程
- **步骤**：
  1. 激活插件并创建Webview
  2. 从Webview发送命令执行请求，指定主执行模式
  3. 验证命令被正确传递给TerminalManager
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证执行结果以JSON格式正确返回给前端
- **预期结果**：完整的命令执行流程正常工作，结果正确显示在前端
- **测试数据**：测试命令和执行模式
- **测试工具**：Jest, VSCode Test API

**测试用例16：命令执行界面模式集成测试**
- **目的**：验证从前端界面输入命令到后端使用界面输出模式（调用tools/execinfo.py）执行的完整流程
- **步骤**：
  1. 激活插件并创建Webview
  2. 从Webview发送命令执行请求，指定界面输出模式
  3. 验证命令被正确传递给TerminalManager
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证执行结果以JSON格式正确返回给前端
- **预期结果**：完整的命令执行流程正常工作，结果正确显示在前端
- **测试数据**：测试命令和执行模式
- **测试工具**：Jest, VSCode Test API
  3. 点击执行按钮
  4. 验证命令是否被正确发送到后端
  5. 验证后端是否正确执行命令
  6. 验证执行结果是否被正确显示在Webview中
- **预期结果**：命令被正确执行，执行结果被正确显示在Webview中
- **测试数据**：测试命令
- **测试工具**：Jest, VSCode Test API

#### 2.2.2 错误处理集成测试
**测试用例16：错误处理集成测试**
- **目的**：验证系统在遇到错误时的处理能力
- **步骤**：
  1. 激活插件
  2. 执行会导致错误的操作（如执行不存在的命令）
  3. 验证错误是否被正确捕获
  4. 验证错误信息是否被正确展示给用户
- **预期结果**：错误被正确捕获和处理，用户能够看到清晰的错误信息
- **测试数据**：会导致错误的操作
- **测试工具**：Jest, VSCode Test API

#### 2.2.3 Vue应用集成测试
**测试用例17：Vue应用集成测试**
- **目的**：验证Vue应用能够正确集成到Webview中并正常工作
- **步骤**：
  1. 激活插件并打开Webview
  2. 验证Vue应用是否正确初始化
  3. 验证Vue数据绑定是否正常工作
  4. 验证Vue方法调用是否正常
- **预期结果**：Vue应用正确初始化，数据绑定和方法调用正常工作
- **测试数据**：测试数据
- **测试工具**：Jest, VSCode Test API

## 3. 端到端测试

### 3.1 插件基本功能测试

#### 3.1.1 插件激活测试
**测试用例17：插件激活测试**
- **目的**：验证插件能够在VSCode中正确激活
- **步骤**：
  1. 调用extension.activate方法
  2. 检查是否成功初始化管理器
  3. 验证日志记录函数被调用
- **预期结果**：插件成功激活，无错误抛出
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

#### 3.1.2 命令注册测试
**测试用例18：命令注册测试**
- **目的**：验证插件命令是否正确注册
- **步骤**：
  1. 激活插件
  2. 验证vscode.commands.registerCommand被调用
  3. 检查注册的命令ID是否包含核心命令
- **预期结果**：所有必要的命令（showWebview、executeCommand、clearTerminals）都被正确注册
- **测试数据**：命令名称
- **测试工具**：Jest, VSCode Test API

#### 3.1.3 Webview视图提供程序注册测试
**测试用例19：Webview视图提供程序注册测试**
- **目的**：验证Webview视图提供程序是否正确注册
- **步骤**：
  1. 激活插件
  2. 验证vscode.window.registerWebviewViewProvider被调用
- **预期结果**：Webview视图提供程序成功注册
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

#### 3.1.4 Webview界面测试
**测试用例20：Webview界面测试**
- **目的**：验证Webview界面能够正确显示和加载资源
- **步骤**：
  1. 启动VSCode并激活插件
  2. 执行"Interactive Tool: Show Webview"命令
  3. 验证Webview界面是否正确显示
  4. 验证Webview中的资源（如CSS、JavaScript）是否正确加载
- **预期结果**：Webview界面正确显示，所有资源正确加载
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

### 3.2 命令功能测试

#### 3.2.1 showWebview命令测试
**测试用例18：showWebview命令测试**
- **目的**：验证showWebview命令能够正常执行
- **步骤**：
  1. 激活插件
  2. 获取并执行showWebview命令回调
  3. 验证executeCommand被调用
- **预期结果**：命令能够正常执行，无错误抛出
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

#### 3.2.2 executeCommand命令测试 (主执行模式)
**测试用例19：executeCommand主执行模式测试**
- **目的**：验证executeCommand命令能够在主执行模式下正常执行并调用tools/interactive-tool.py
- **步骤**：
  1. 激活插件
  2. 获取并执行executeCommand命令回调，指定主执行模式
  3. 验证命令能够执行而不抛出异常
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证结果以JSON格式返回
- **预期结果**：命令能够正常执行，无错误抛出
- **测试数据**：测试命令和主执行模式参数
- **测试工具**：Jest, VSCode Test API

#### 3.2.3 executeCommand命令测试 (界面输出模式)
**测试用例20：executeCommand界面输出模式测试**
- **目的**：验证executeCommand命令能够在界面输出模式下正常执行并调用tools/execinfo.py
- **步骤**：
  1. 激活插件
  2. 获取并执行executeCommand命令回调，指定界面输出模式
  3. 验证命令能够执行而不抛出异常
  4. 验证TerminalManager调用了正确的Python脚本
  5. 验证结果以JSON格式返回
- **预期结果**：命令能够正常执行，无错误抛出
- **测试数据**：测试命令和界面输出模式参数
- **测试工具**：Jest, VSCode Test API

#### 3.2.4 clearTerminals命令测试
**测试用例21：clearTerminals命令测试**
- **目的**：验证clearTerminals命令能够正常执行
- **步骤**：
  1. 激活插件
  2. 模拟TerminalManager的disposeAllTerminals方法
  3. 获取并执行clearTerminals命令回调
  4. 验证是否调用了TerminalManager清除终端
- **预期结果**：命令能够正常执行，调用了相应的TerminalManager方法
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

### 3.3 Webview功能测试

#### 3.3.1 Webview输入测试
**测试用例22：Webview输入测试**
- **目的**：验证Webview中的输入框能够正确接收用户输入
- **步骤**：
  1. 启动VSCode并激活插件
  2. 打开Webview
  3. 在输入框中输入文本
  4. 验证输入框能够正确接收和显示输入内容
- **预期结果**：输入框能够正确接收和显示用户输入的内容
- **测试数据**：测试文本
- **测试工具**：Jest, VSCode Test API

#### 3.3.2 Webview命令执行测试 (主执行模式)
**测试用例23：Webview主执行模式命令测试**
- **目的**：验证用户能够在Webview中输入并以主执行模式执行命令
- **步骤**：
  1. 启动VSCode并激活插件
  2. 打开Webview
  3. 在输入框中输入测试命令
  4. 选择主执行模式
  5. 点击执行按钮
  6. 验证命令是否正确执行
  7. 验证执行结果是否正确显示在Webview中
- **预期结果**：命令正确执行，执行结果正确显示在Webview中
- **测试数据**：测试命令
- **测试工具**：Jest, VSCode Test API

#### 3.3.3 Webview命令执行测试 (界面输出模式)
**测试用例24：Webview界面输出模式命令测试**
- **目的**：验证用户能够在Webview中输入并以界面输出模式执行命令
- **步骤**：
  1. 启动VSCode并激活插件
  2. 打开Webview
  3. 在输入框中输入测试命令
  4. 选择界面输出模式
  5. 点击执行按钮
  6. 验证命令是否正确执行
  7. 验证执行结果是否正确显示在Webview中
- **预期结果**：命令正确执行，执行结果正确显示在Webview中
- **测试数据**：测试命令
- **测试工具**：Jest, VSCode Test API

#### 3.3.4 Webview消息通信测试
**测试用例25：Webview消息通信测试**
- **目的**：验证Webview与插件之间的消息通信功能
- **步骤**：
  1. 启动VSCode并激活插件
  2. 打开Webview
  3. 执行会触发消息发送的操作
  4. 验证消息是否被正确发送和处理
- **预期结果**：消息被正确发送和处理
- **测试数据**：测试操作
- **测试工具**：Jest, VSCode Test API

#### 3.3.5 Webview相关操作触发测试
**测试用例26：Webview相关操作触发测试**
- **目的**：验证能够成功触发Webview相关操作
- **步骤**：
  1. 激活插件
  2. 获取并执行showWebview命令回调
  3. 验证命令回调存在
- **预期结果**：能够成功触发Webview相关操作
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

#### 3.3.6 Vue组件功能测试
**测试用例27：Vue组件功能测试**
- **目的**：验证Vue组件的功能是否正常工作
- **步骤**：
  1. 激活插件并打开Webview
  2. 测试Vue组件的各种功能
  3. 验证组件的状态管理和事件处理
- **预期结果**：Vue组件的各种功能正常工作
- **测试数据**：测试数据
- **测试工具**：Jest, VSCode Test API

### 3.4 插件禁用流程测试

#### 3.4.1 插件禁用测试
**测试用例28：插件禁用测试**
- **目的**：验证插件能够正确禁用并清理资源
- **步骤**：
  1. 启动VSCode并激活插件
  2. 禁用插件
  3. 验证插件是否正确禁用
  4. 验证所有相关资源是否被正确清理
- **预期结果**：插件正确禁用，所有相关资源被正确清理
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

#### 3.4.2 插件资源清理测试
**测试用例29：插件资源清理测试**
- **目的**：验证插件能够正确清理资源
- **步骤**：
  1. 激活插件
  2. 添加模拟的订阅
  3. 手动清理订阅以模拟禁用过程
  4. 验证所有订阅都被清理
- **预期结果**：所有资源都被正确清理
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

### 3.5 错误处理测试

#### 3.5.1 命令执行错误处理测试 (主执行模式)
**测试用例30：主执行模式错误处理测试**
- **目的**：验证插件能够正确处理主执行模式下命令执行失败的情况
- **步骤**：
  1. 激活插件
  2. 模拟TerminalManager在主执行模式下的executeCommand方法抛出异常
  3. 获取并执行executeCommand命令回调，指定主执行模式
  4. 验证错误日志记录
  5. 验证错误信息以JSON格式返回给前端
- **预期结果**：能够正确捕获异常并记录错误日志，错误信息正确返回
- **测试数据**：会导致执行失败的命令
- **测试工具**：Jest, VSCode Test API

#### 3.5.2 命令执行错误处理测试 (界面输出模式)
**测试用例31：界面输出模式错误处理测试**
- **目的**：验证插件能够正确处理界面输出模式下命令执行失败的情况
- **步骤**：
  1. 激活插件
  2. 模拟TerminalManager在界面输出模式下的executeCommand方法抛出异常
  3. 获取并执行executeCommand命令回调，指定界面输出模式
  4. 验证错误日志记录
  5. 验证错误信息以JSON格式返回给前端
- **预期结果**：能够正确捕获异常并记录错误日志，错误信息正确返回
- **测试数据**：会导致执行失败的命令
- **测试工具**：Jest, VSCode Test API

#### 3.5.3 资源加载错误处理测试
**测试用例32：资源加载错误处理测试**
- **目的**：验证当Webview资源加载失败时，系统能够正确处理
- **步骤**：
  1. 模拟Webview资源文件缺失或损坏
  2. 启动VSCode并激活插件
  3. 打开Webview
  4. 验证Webview是否能够使用备用资源或显示错误信息
- **预期结果**：Webview能够使用备用资源或显示清晰的错误信息
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

#### 3.5.4 Vue资源加载错误处理测试
**测试用例33：Vue资源加载错误处理测试**
- **目的**：验证当Vue相关资源加载失败时，系统能够正确处理
- **步骤**：
  1. 模拟Vue库文件缺失或损坏
  2. 启动VSCode并激活插件
  3. 打开Webview
  4. 验证Webview是否能够使用备用方案或显示错误信息
- **预期结果**：Webview能够使用备用方案或显示清晰的错误信息
- **测试数据**：无
- **测试工具**：Jest, VSCode Test API

## 4. 测试目录结构详细规划

### 4.1 单元测试目录 - test/unit/
- **职责**：验证独立模块的功能，确保每个组件和函数按预期工作
- **文件命名规范**：`[module-name].test.ts`
- **测试范围**：
  - 函数逻辑测试
  - 类的方法测试
  - 数据处理测试
- **工具选择**：Jest

### 4.2 集成测试目录 - test/integration/
- **职责**：测试模块间的交互和协作
- **文件命名规范**：`[scenario-name].test.ts`
- **测试范围**：
  - 组件间通信测试
  - 服务调用链测试
  - API集成测试
- **工具选择**：Jest + VSCode Test API

### 4.3 端到端测试目录 - test/e2e/
- **职责**：验证完整的用户流程，模拟真实用户操作场景
- **文件命名规范**：`[scenario-name].test.ts`
- **测试范围**：
  - 用户交互流程测试
  - 完整功能链路测试
  - 错误场景处理测试
- **工具选择**：Jest + VSCode Test API

### 4.4 测试工具目录 - test/utils/
- **职责**：存放测试工具函数和辅助类，提供测试通用功能
- **文件命名规范**：`[utility-name].ts`
- **工具类型**：
  - 测试辅助函数
  - 模拟上下文对象

### 4.5 模拟数据目录 - test/mocks/
- **职责**：存放测试模拟数据和对象
- **文件命名规范**：`[mock-name].js`
- **模拟类型**：
  - VSCode API模拟
  - 终端模拟
  - Webview模拟

### 4.6 测试文件结构示例
```
test/
  ├── unit/
  │   ├── htmlTemplate.test.ts
  │   ├── logger.test.ts
  │   ├── terminalManager.test.ts
  │   └── webviewManager.test.ts
  ├── integration/
  │   ├── extensionIntegration.test.ts
  │   ├── commandExecution.test.ts
  │   └── webviewTemplate.test.ts
  ├── e2e/
  │   └── extensionEndToEnd.test.ts
  ├── mocks/
  │   ├── vscode.js
  │   ├── terminal.js
  │   └── webview.js
  └── utils/
      └── testHelpers.ts
```

## 5. 测试策略

### 5.1 测试覆盖率目标
- **单元测试覆盖率**: 核心模块达到80%以上
- **集成测试覆盖率**: 关键业务流程达到100%覆盖
- **端到端测试覆盖率**: 主要用户场景达到100%覆盖

### 5.2 测试自动化
- 使用CI/CD管道自动执行所有测试
- 每次代码提交后自动运行单元测试和集成测试
- 每日构建自动运行端到端测试
- 生成测试覆盖率报告

### 5.3 测试环境管理
- 为不同类型的测试提供适合的测试环境
- 确保测试环境的一致性和可重现性
- 使用模拟对象和工具减少对外部依赖的需求

### 5.4 代码覆盖率统计
- 集成代码覆盖率工具，对每个构建进行覆盖率统计
- 生成详细的覆盖率报告，包括行覆盖率、函数覆盖率和分支覆盖率
- 设置覆盖率阈值，确保代码质量