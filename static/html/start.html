<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Tool - 启动页面</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 25px;
        }
        .api-status {
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
            background-color: #e8f4fd;
            border-left: 4px solid #3498db;
        }
        .api-status.connected {
            background-color: #e8f8f5;
            border-left-color: #27ae60;
        }
        .api-status.error {
            background-color: #fdedec;
            border-left-color: #e74c3c;
        }
        .button {
            display: inline-block;
            background-color: #3498db;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 4px;
            font-weight: bold;
            transition: background-color 0.3s;
            margin: 10px 0;
        }
        .button:hover {
            background-color: #2980b9;
        }
        .button.secondary {
            background-color: #95a5a6;
        }
        .button.secondary:hover {
            background-color: #7f8c8d;
        }
        .instructions {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .instructions ol {
            margin-top: 10px;
        }
        .instructions li {
            margin-bottom: 8px;
        }
        code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background-color: #f1f1f1;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .section {
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Interactive Tool - 启动页面</h1>
        
        <div class="section">
            <h2>API服务器状态</h2>
            <div id="api-status" class="api-status">
                <p>正在检查API服务器连接状态...</p>
            </div>
        </div>
        
        <div class="section">
            <h2>使用说明</h2>
            <div class="instructions">
                <p>此页面提供了一个不依赖VSCode插件，可以直接在浏览器中运行的Interactive Tool版本。请按照以下步骤使用：</p>
                <ol>
                    <li>确保上方显示API服务器已连接。如果未连接，请确认是否已启动REST API服务器。</li>
                    <li>点击下方的"打开浏览器版Interactive Tool"按钮。</li>
                    <li>在打开的界面中，可以选择工具、输入命令并执行。</li>
                    <li>工具执行的结果将实时显示在界面上。</li>
                </ol>
            </div>
        </div>
        
        <div class="section">
            <h2>访问链接</h2>
            <a href="browser-webview.html" class="button" target="_blank">打开浏览器版Interactive Tool</a>
            <br>
            <a href="chat-webview.html" class="button" target="_blank">打开多轮对话界面</a>
            <br>
            <a href="http://localhost:5000/api/test" class="button secondary" target="_blank">测试API连接</a>
        </div>
        
        <div class="section">
            <h2>常见问题</h2>
            <ul>
                <li><strong>Q: API服务器连接失败怎么办？</strong><br>
                A: 请确保已在tools目录下运行 <code>python rest_api_server.py</code> 启动了API服务器。</li>
                <li><strong>Q: 支持哪些工具？</strong><br>
                A: 当前支持execinfo.py和interactive_tool.py两个工具，它们必须位于tools目录下。</li>
                <li><strong>Q: 如何关闭API服务器？</strong><br>
                A: 在启动服务器的终端中按Ctrl+C即可关闭。</li>
            </ul>
        </div>
    </div>

    <script>
        // 检查API服务器连接状态
        document.addEventListener('DOMContentLoaded', function() {
            const apiStatusElement = document.getElementById('api-status');
            const apiUrl = 'http://localhost:5000/api/test';
            
            fetch(apiUrl)
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error(`HTTP错误: ${response.status}`);
                    }
                })
                .then(data => {
                    apiStatusElement.className = 'api-status connected';
                    apiStatusElement.innerHTML = `
                        <p><strong>✅ API服务器已连接成功！</strong></p>
                        <p>版本: ${data.version}</p>
                        <p>工具目录: ${data.tools_dir}</p>
                    `;
                })
                .catch(error => {
                    apiStatusElement.className = 'api-status error';
                    apiStatusElement.innerHTML = `
                        <p><strong>❌ API服务器连接失败！</strong></p>
                        <p>错误信息: ${error.message}</p>
                        <p>请确认是否已在tools目录下运行 <code>python rest_api_server.py</code></p>
                    `;
                });
        });
    </script>
</body>
</html>